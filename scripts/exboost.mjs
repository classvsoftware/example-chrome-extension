var e = { d: (t, n) => { for (var o in n) e.o(n, o) && !e.o(t, o) && Object.defineProperty(t, o, { enumerable: !0, get: n[o] }); }, o: (e, t) => Object.prototype.hasOwnProperty.call(e, t) }, t = {}; e.d(t, { A: () => i }); const n = "v1"; var o; !function (e) { e.BACKGROUND = "BACKGROUND", e.CONTENT_SCRIPT = "CONTENT_SCRIPT", e.EXTENSION_PAGE = "EXTENSION_PAGE", e.POPUP = "POPUP", e.OPTIONS = "OPTIONS", e.SIDEBAR = "SIDEBAR", e.DEVELOPER_TOOLS = "DEVELOPER_TOOLS", e.UNIDENTIFIED_CONTEXT = "UNIDENTIFIED_CONTEXT"; }(o || (o = {})); var s = function (e, t, n, o) { return new (n || (n = Promise))((function (s, i) { function r(e) { try { h(o.next(e)); } catch (e) { i(e); } } function a(e) { try { h(o.throw(e)); } catch (e) { i(e); } } function h(e) { var t; e.done ? s(e.value) : (t = e.value, t instanceof n ? t : new n((function (e) { e(t); }))).then(r, a); } h((o = o.apply(e, t || [])).next()); })); }; const i = new class { constructor() { this.version = "1.12.2", this.apiOrigin = "https://api.extensionboost.com", this.sessionId = null, this.windowIsDefined = "undefined" != typeof window, this.chromeGlobalIsDefined = "undefined" != typeof chrome, this.isManifestV2 = null, this.usesExtensionProtocol = !!this.windowIsDefined && "chrome-extension:" === window.location.protocol, this.extensionId = null, this.extensionName = null, this.chromeGlobalIsDefined && (this.extensionId = chrome.runtime.id, this.extensionName = chrome.runtime.getManifest().name, this.isManifestV2 = "2" === chrome.runtime.getManifest().version), !1 === this.isManifestV2 && !this.windowIsDefined && this.chromeGlobalIsDefined || !0 === this.isManifestV2 && this.windowIsDefined && window === chrome.extension.getBackgroundPage() ? this.engineContext = o.BACKGROUND : this.windowIsDefined && this.chromeGlobalIsDefined && this.usesExtensionProtocol ? this.engineContext = o.EXTENSION_PAGE : this.windowIsDefined && this.chromeGlobalIsDefined && !this.usesExtensionProtocol ? this.engineContext = o.CONTENT_SCRIPT : this.engineContext = o.UNIDENTIFIED_CONTEXT, this.engineInit(); } engineInit() { switch (this.engineContext) { case o.BACKGROUND: this.initBackground(); case o.CONTENT_SCRIPT: case o.DEVELOPER_TOOLS: case o.EXTENSION_PAGE: case o.OPTIONS: case o.POPUP: } } renderSlotDataOrError({ exboostSlotId: e, target: t, containerClass: n, linkClass: o }, i = {}) { return s(this, void 0, void 0, (function* () { const s = yield this.loadSlotDataOrError({ exboostSlotId: e }); t.innerHTML = `<div class="exboost-container ${null != n ? n : ""}">\n      ${s.anchorData.map((e => `<a class="exboost-link ${null != o ? o : ""}" href="${e.href}" target="_blank">${e.text}</a>`)).join("")}\n    </div>`; })); } loadSlotDataOrError({ exboostSlotId: e }, t = {}) { return s(this, void 0, void 0, (function* () { if (!e) throw new Error("Must provide exboostSlotId"); const n = { exboostSlotId: e, engineContext: this.engineContext, options: t }, o = yield chrome.runtime.sendMessage(n); if (!o.success) throw new Error("Failed to load ExBoost slot data"); return o.exboostSlotData; })); } initBackground() { this.sessionId = crypto.randomUUID(), chrome.runtime.onMessage.addListener(((e, t, o) => { if (!Object.keys(e).includes("exboostSlotId")) return; const s = [n, "links"].join("/"), i = new URLSearchParams({ sessionId: this.sessionId, engineContext: e.engineContext, slotId: e.exboostSlotId, version: this.version, publisherExtensionId: this.extensionId, publisherExtensionName: this.extensionName }); return fetch(`${this.apiOrigin}/${s}?nonce=${Date.now()}&${i.toString()}`).then((e => { if (200 !== e.status) { const e = { success: !1, exboostSlotData: { anchorData: [] } }; return Promise.resolve(e); } return e.json().then((e => ({ success: !0, exboostSlotData: e }))); })).then((e => o(e))), !0; })); } }; var r = t.A; export { r as default };
